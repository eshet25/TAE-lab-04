---
title: "Lab 04 - La Quinta is Spanish for next to Denny's, Pt. 1"
author: "Tsion"
date: "02-08-2026"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 
```

*Install dsbox first
```{r install-dsbox}
#manually downloaded and opened the two datasets.
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
```

```{r assign-shorter-values-for-datasets }
dn <- dennys
lq <- laquinta
```


### Exercise 1

```{r dennys-dimensions}
nrow(dn)
ncol(dn)
```

The Dennys dataset contains `r nrow(dn)` and `r ncol(dn)` columns. The rows represent a Denny's restaurant the data contains. The variables are address, city, state, zip (code), longitude, and latitude. 

### Exercise 2

```{r laquinta-dimensions}
nrow(lq)
ncol(lq)
```

The Laquinta dataset contains `r nrow(lq)` and `r ncol(lq)` columns. The rows represent a Laquinta hotel the data contains. The variables are address, city, state, zip (code), longitude, and latitude (same as the dennys' dataset). 

### Exercise 3

Laquinta hotels have locations in the following places outisde of US:

North America: Canada, Mexico

Asia: China

Australia & the Pacific Rim: New Zealnd

Europe: Georgia, Turkiye

Middle East: UAE (Abu Dhabi, Dubai)

South America: Colomibia, Ecuador

For Denny's, the link only shows the U.S locations. It lists "View U.S Locations (1257)" in the website. But our dataset contains 1643 observations so I suspected there might be locations outside the U.S that we just can't access through the website. But I am also not sure why the numbers in our dataset are higher since it looks like it's listing the (US) states and zip codes there too. 

I did a general google search, and wikipedia says, "It operates over 1,400 restaurants in the United States, Canada, México, Puerto Rico, and several other international locations." (https://en.wikipedia.org/wiki/Denny%27s) 

However, I wasn't able to find a specific link that shows the different Denny's locations outside the U.S. 

### Exercise 4

The first idea I had was to look at the latitude and longitude data and filter out the places that would be outside of the U.S. But then, I took a brief look at the dennys dataset, and it looks like most of the abbreviations under the column "state" were US states. So, I thought maybe looking at what distinct states are included in the data will let me know whether we have stores outside the US (at least in the context of our data). 

So, I would use a function to list all the unique values that are included in the "state" column of our data, and also maybe see the counts of the distinct values as well. If the output shows all states that are US states, I would think the data only contans US locations. 

### Exercise 5

```{r filter-states-outisde-us-dennys}
dn %>%
  filter(!(state %in% states$abbreviation))
#Filter for states that are not in states$abbreviation
```

As I suspected, there are no US locations for Denny's in this dataset.

### Exercise 6

```{r add-country-variable-to-dennys}
dn %>%
  mutate(country = "United States")
#Mutate for new variable and set all observations equal to "United States".
#We don’t need to tell R how many times to repeat the character string “United States” to fill in the data for all observations, R takes care of that automatically.
```

```{r save-the-new-variable}
dn <- dn %>%
  mutate(country = "United States")
```

### Exercise 7

```{r filter-states-outisde-us-laquinta}
lq %>%
  filter(!(state %in% states$abbreviation))
```

There are 14 locations of Laquinta outside of the US in this dataset. After searching up the abbreviations,here are the locations:

Mexico: AG (Aguascalientes), QR (Quintana Roo), CH (Chihuahua), NL (Nuevo León), VE	(Veracruz), PU	(Puebla) & SL	(San Luis Potosí).

Colombia: ANT (Antioquia)

Canada: ON (Ontario), BC (British Columbia).

Honduras: FM (Francisco Morazán).

### Exercise 8

```{r add-country-variable-for-laquinta}
lq <- lq %>%
  mutate(country = case_when(
    state %in% state.abb ~ "United States",
    state %in% c("ON", "BC") ~ "Canada",
    state == "ANT" ~ "Colombia",
    state == "FM" ~ "Honduras",
    state %in% c("AG", "QR", "CH", "NL", "VE", "PU", "SL") ~ "Mexico"
  ))
```

```{r only-US-locations-for-laquinta}
lq <- lq %>%
  filter(country == "United States")
```

The laquinta (lq) dataset now has `r nrow(lq)` rows after filtering only US locations. 

### Exercise 9

```{r dennys-states-count}
dn_count_states <- dn %>%
  count(state) %>%
  inner_join(states, by = c("state" = "abbreviation"))
```

```{r most-states}
dn_count_states %>%
  arrange(desc(n))
```

California has the most Denny's locations (403), which is double the amount from the second state, Texas (200). This was a bit surprising, since the area for Texas is almost double the size of California, you'd think there would be more Denny's there or at least a close number of locations between the two. 

```{r least-states}
dn_count_states %>%
  arrange(n)
```

Delaware is the state that has the least amount of Denny's locations, with only 1. 

```{r laquinta-states-count}
lq_count_states <- lq %>%
  count(state) %>%
  inner_join(states, by = c("state" = "abbreviation"))
```

```{r lq-most-states}
lq_count_states %>%
  arrange(desc(n))
```

Texas has the most Laquinta locations with 237. This wasn't very surprising. What was surprising was the total amount, compared to the states following up. After Texas, we see that the number quickly drops below 100 for the other states. 

```{r lq-least-states}
lq_count_states %>%
  arrange(n)
```

Maine has the least number of Laquinta locations, with only 1. 

### Exercise 10

```{r most-dennys-per-thousand-square-miles}
dn_count_states <- dn_count_states %>%
  mutate (dennys_per_1000_sq_miles = n / (area/1000))
dn_count_states %>%
  arrange(desc(dennys_per_1000_sq_miles))
```

DC has the most Denny's locations per thousand sq miles, with 29.3, with Rhode Island as second place but with only 3.24. 

```{r most-laquintas-per-thousand-square-miles}
lq_count_states <- lq_count_states %>%
  mutate (laquintas_per_1000_sq_miles = n / (area/1000))
lq_count_states %>%
  arrange(desc(laquintas_per_1000_sq_miles))
```

For Laquinta, Rhode island has the most per thousand sq miles, but only 1.29.

### Exercise 11

```{r add-identifier-variable}
dn <- dn %>%
  mutate(establishment = "Denny's")
lq <- lq %>%
  mutate(establishment = "La Quinta")
```

```{r bind-rows-to-put-them-to-single-df}
dn_lq <- bind_rows(dn, lq)
```

```{r plot-locations-of-the-two-establishments}
ggplot(dn_lq, mapping = aes(
  x = longitude,
  y = latitude,
  color = establishment
)) +
  geom_point() +
  scale_color_viridis_d() +
labs(
  title = "Location of Denny's and La Quinta Establishments",
  x = "Longitude",
  y = "Latitude",
  color = "Establishment",
) +
   theme_bw()
```

```{r filter-plot-for-NC-only}
ggplot(
  dn_lq %>% filter(state == "NC"),
  aes(
    x = longitude,
    y = latitude,
    color = establishment
)) +
  geom_point(alpha = 0.7) +
  scale_color_viridis_d() +
labs(
  title = "Location of Denny's and La Quinta Establishments",
  subtitle = "In North Carolina",
  x = "Longitude",
  y = "Latitude",
  color = "Establishment",
) +
   theme_bw()
```

From the data, it doesn't look like Mitch Hedberg's joke holds that Denny's and LaQuinta are always next to each other. We can see that there are significantly more Denny's in NC than LaQuintas. 

### Exercise 12

```{r filter-plot-for-Texas-only}
ggplot(
  dn_lq %>% filter(state == "TX"),
  aes(
    x = longitude,
    y = latitude,
    color = establishment
)) +
  geom_point(alpha = 0.3) +
  scale_color_viridis_d() +
labs(
  title = "Location of Denny's and La Quinta Establishments",
  subtitle = "In Texas",
  x = "Longitude",
  y = "Latitude",
  color = "Establishment",
) +
   theme_bw()
```

Mitch Hedberg's joke does seem to hold in Texas, since most Denny's and Laquintas appear to be clustered all together. 

### Exercise 13

```{r load-packages-for-globe-plot}
library(ggplot2)
library(mapproj)
```

```{r recreate-map-plot}
ggplot (dn_lq,aes(
  x = longitude,
  y = latitude,
  color = establishment
)) +
  geom_point(alpha = 0.6, size = 1) +
  annotation_borders (color = "gray50") +
  coord_map("ortho", orientation = c(30, -100,0), xlim = c(-170,-30),ylim = c(10,70))+
labs(
    title = "Denny's and La Quinta Locations in the Western Hemisphere",
    x = "Longitude",
    y = "Latitude",
    color = "Establishment"
  ) +
  theme_bw()

#annotation_borders() means to draw outlines, so that the points aren't just floating around.
#coord_map controls the overall curve of the Earth and how we project it to the plot
#ortho is orthographic projection, which makes the earth look like a sort of viewed from above, and then we put the approximate coordinates for the western hemi.
```

*Yikes! That definitely didn't go as planned. :/ Navigating #13 turned out harder than I anticipated. I'm not sure how to display NA values instead of La Quinta. 
